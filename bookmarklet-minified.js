// ‚úÖ COPY THIS ENTIRE LINE FOR BOOKMARKING ‚úÖ
// This is the version you copy-paste into your browser bookmark URL
javascript:(function(){'use strict';console.log('üîç Starting PubMed Filename Generator...');const existingDialog=document.getElementById('pubmed-filename-dialog');if(existingDialog){existingDialog.remove()}let journal='Unknown';const publisherMeta=document.querySelector('meta[name="citation_publisher"]');if(publisherMeta&&journal==='Unknown'){journal=publisherMeta.getAttribute('content')}const journalMeta=document.querySelector('meta[name="citation_journal_title"]');if(journalMeta&&journal==='Unknown'){journal=journalMeta.getAttribute('content')}const journalButton=document.querySelector('.journal-actions-trigger, button[aria-label*="journal"]');if(journalButton&&journal==='Unknown'){journal=journalButton.textContent.trim()}let year=new Date().getFullYear();const citationEl=document.querySelector('.cit');if(citationEl){const yearMatch=citationEl.textContent.match(/(\d{4})/);if(yearMatch){year=yearMatch[1]}}if(year===new Date().getFullYear()){const dateMeta=document.querySelector('meta[name="citation_date"]');if(dateMeta){const yearMatch=dateMeta.getAttribute('content').match(/(\d{4})/);if(yearMatch){year=yearMatch[1]}}}let firstAuthor='Unknown';const authorLink=document.querySelector('.authors a:first-child, .auths a:first-child');if(authorLink){const fullName=authorLink.textContent.trim().replace(/\d+/g,'').replace(/\s+/g,' ').trim();const parts=fullName.split(/\s+/);if(parts.length>0){firstAuthor=parts[parts.length-1]}}if(firstAuthor==='Unknown'){const authorMeta=document.querySelector('meta[name="citation_author"]');if(authorMeta){const content=authorMeta.getAttribute('content');const parts=content.split(',')[0].trim().split(/\s+/);if(parts.length>0){firstAuthor=parts[parts.length-1]}}}let pmid='Unknown';const bodyText=document.body.textContent;const pmidMatch=bodyText.match(/PMID:\s*(\d+)/);if(pmidMatch){pmid=pmidMatch[1]}if(pmid==='Unknown'){const urlMatch=window.location.pathname.match(/\/(\d+)\/?$/);if(urlMatch){pmid=urlMatch[1]}}if(journal==='Unknown'||pmid==='Unknown'){alert('‚ùå Could not extract required metadata from this PubMed page.\n\nJournal: '+journal+'\nPMID: '+pmid);return}const dialog=document.createElement('div');dialog.id='pubmed-filename-dialog';dialog.style.cssText='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;border:2px solid #007cba;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.3);z-index:10000;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;min-width:400px;max-width:600px;padding:24px';dialog.innerHTML=`<div style="margin-bottom:20px"><h3 style="margin:0 0 10px 0;color:#007cba;font-size:18px">üìÅ PubMed Filename Generator</h3><p style="margin:0;color:#666;font-size:14px">Review and customize your filename:</p></div><div style="margin-bottom:15px"><label style="display:block;font-weight:600;margin-bottom:5px;color:#333">Journal:</label><input type="text" id="journal-input" value="${journal}" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;font-size:14px" readonly></div><div style="margin-bottom:15px"><label style="display:block;font-weight:600;margin-bottom:5px;color:#333">Year:</label><input type="text" id="year-input" value="${year}" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;font-size:14px" readonly></div><div style="margin-bottom:15px"><label style="display:block;font-weight:600;margin-bottom:5px;color:#333">First Author (editable):</label><input type="text" id="author-input" value="${firstAuthor}" style="width:100%;padding:8px;border:1px solid #007cba;border-radius:4px;font-size:14px"></div><div style="margin-bottom:15px"><label style="display:block;font-weight:600;margin-bottom:5px;color:#333">Short Reference <span style="color:#e74c3c">*</span>:</label><input type="text" id="ref-input" placeholder="e.g. Global status male fert" style="width:100%;padding:8px;border:1px solid #007cba;border-radius:4px;font-size:14px"></div><div style="margin-bottom:15px"><label style="display:block;font-weight:600;margin-bottom:5px;color:#333">PMID:</label><input type="text" id="pmid-input" value="${pmid}" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;font-size:14px" readonly></div><div style="margin-bottom:20px;padding:12px;background:#f8f9fa;border-radius:6px;border:1px solid #e9ecef"><label style="display:block;font-weight:600;margin-bottom:8px;color:#333">Generated Filename:</label><textarea id="filename-preview" readonly style="width:100%;height:60px;padding:8px;border:1px solid #ddd;border-radius:4px;font-size:12px;font-family:monospace;background:white;resize:none"></textarea></div><div style="text-align:right"><button id="cancel-btn" style="background:#6c757d;color:white;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;margin-right:10px;font-size:14px">Cancel</button><button id="copy-btn" style="background:#007cba;color:white;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600">üìã Copy Filename</button></div>`;document.body.appendChild(dialog);const authorInput=document.getElementById('author-input');const refInput=document.getElementById('ref-input');const filenamePreview=document.getElementById('filename-preview');const copyBtn=document.getElementById('copy-btn');const cancelBtn=document.getElementById('cancel-btn');function updatePreview(){const author=authorInput.value.trim()||firstAuthor;const ref=refInput.value.trim();if(ref){const filename=`${journal} ${year} ${author} ${ref} ${pmid}.pdf`;filenamePreview.value=filename;copyBtn.disabled=false;copyBtn.style.opacity='1'}else{filenamePreview.value=`${journal} ${year} ${author} [SHORT_REF] ${pmid}.pdf`;copyBtn.disabled=true;copyBtn.style.opacity='0.5'}}authorInput.addEventListener('input',updatePreview);refInput.addEventListener('input',updatePreview);copyBtn.addEventListener('click',function(){const filename=filenamePreview.value;if(navigator.clipboard){navigator.clipboard.writeText(filename).then(()=>{alert('‚úÖ Filename copied to clipboard!\n\n'+filename);dialog.remove()}).catch(()=>{filenamePreview.select();document.execCommand('copy');alert('‚úÖ Filename copied to clipboard!\n\n'+filename);dialog.remove()})}else{filenamePreview.select();document.execCommand('copy');alert('‚úÖ Filename copied to clipboard!\n\n'+filename);dialog.remove()}});cancelBtn.addEventListener('click',function(){dialog.remove()});refInput.addEventListener('keydown',function(e){if(e.key==='Enter'&&refInput.value.trim()){copyBtn.click()}});updatePreview();refInput.focus()})();